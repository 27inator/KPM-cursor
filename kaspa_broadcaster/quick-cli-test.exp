#!/usr/bin/expect -f

set timeout 10
set kaspa_cli "../rusty-kaspa/target/release/kaspa-cli"

log_user 1

puts "ğŸ§ª QUICK KASPA-CLI CONNECTION TEST"
puts "================================="

spawn $kaspa_cli
expect "$ "

puts "ğŸ”Œ Testing connection to local node..."
send "server 127.0.0.1:17210\r"
expect "$ "

send "connect\r"
expect {
    "Connected" {
        puts "âœ… kaspa-cli connected successfully!"
        send "ping\r"
        expect "$ "
        puts "âœ… Node is responding!"
    }
    "Error" {
        puts "âŒ kaspa-cli connection failed"
    }
    timeout {
        puts "â³ Connection timed out"
    }
}

send "exit\r"
expect eof

puts "âœ… CLI test complete" 